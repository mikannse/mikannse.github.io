<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>THMEnumeration | MikannseのSekai</title><meta name="author" content="Mikannse"><meta name="copyright" content="Mikannse"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Introduction本房间专注于后漏洞利用枚举。换句话说，我们假设我们已经成功获得了某种形式的系统访问权限。此外，我们可能已经进行了权限提升；换句话说，我们可能在目标系统上拥有管理员或 root 权限。即使使用非特权帐户（即非 root 或管理员），本房间讨论的一些技术和工具仍然可以提供有用的输出。 如果您对权限提升感兴趣，可以查看 Windows 权限提升 房间和 Linux 权限提升 房间">
<meta property="og:type" content="article">
<meta property="og:title" content="THMEnumeration">
<meta property="og:url" content="https://blog.mikannse.cn/2025/06/13/THMEnumeration/index.html">
<meta property="og:site_name" content="MikannseのSekai">
<meta property="og:description" content="Introduction本房间专注于后漏洞利用枚举。换句话说，我们假设我们已经成功获得了某种形式的系统访问权限。此外，我们可能已经进行了权限提升；换句话说，我们可能在目标系统上拥有管理员或 root 权限。即使使用非特权帐户（即非 root 或管理员），本房间讨论的一些技术和工具仍然可以提供有用的输出。 如果您对权限提升感兴趣，可以查看 Windows 权限提升 房间和 Linux 权限提升 房间">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2023/06/22/PMAjL6lORKa5CGy.jpg">
<meta property="article:published_time" content="2025-06-13T08:51:27.000Z">
<meta property="article:modified_time" content="2025-06-13T08:52:33.091Z">
<meta property="article:author" content="Mikannse">
<meta property="article:tag" content="笔记">
<meta property="article:tag" content="后渗透">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/06/22/PMAjL6lORKa5CGy.jpg"><link rel="shortcut icon" href="/img/icon.jpg"><link rel="canonical" href="https://blog.mikannse.cn/2025/06/13/THMEnumeration/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Mikannse","link":"链接: ","source":"来源: MikannseのSekai","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'THMEnumeration',
  isPost: true,
  isHome: false,
  isHighlightShrink: undefined,
  isToc: true,
  postUpdate: '2025-06-13 16:52:33'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (true) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2023/06/22/PMAjL6lORKa5CGy.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">345</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">76</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/yjr-1100/Photobag/githubioimg/background_4k.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="MikannseのSekai"><span class="site-name">MikannseのSekai</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">THMEnumeration</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-06-13T08:51:27.000Z" title="发表于 2025-06-13 16:51:27">2025-06-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-06-13T08:52:33.091Z" title="更新于 2025-06-13 16:52:33">2025-06-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BD%91%E5%AE%89/">网安</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>28分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="THMEnumeration"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>本房间专注于后漏洞利用枚举。换句话说，我们假设我们已经成功获得了某种形式的系统访问权限。此外，我们可能已经进行了权限提升；换句话说，我们可能在目标系统上拥有管理员或 root 权限。即使使用非特权帐户（即非 root 或管理员），本房间讨论的一些技术和工具仍然可以提供有用的输出。</p>
<p>如果您对权限提升感兴趣，可以查看 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/windowsprivesc20">Windows 权限提升</a> 房间和 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/linprivesc">Linux 权限提升</a> 房间。此外，还有两个方便的脚本：<a target="_blank" rel="noopener" href="https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS">WinPEAS</a> 和 <a target="_blank" rel="noopener" href="https://grimbins.github.io/grimbins/linpeas/">LinPEAS</a>，分别用于 MS Windows 和 Linux 权限提升。</p>
<p>我们的目的是收集更多信息，以帮助我们获得更多目标网络访问权限。例如，我们可能会找到授予其他系统访问权限的登录凭据。我们专注于标准系统上常用的工具，以收集有关目标的更多信息。作为系统的一部分，这些工具看起来无害，并且产生的“噪音”最少。</p>
<p>我们假设您可以访问目标上的命令行界面，例如 Linux 系统上的“bash”或 MS Windows 系统上的“cmd.exe”。在 Linux 系统上，从一种 Shell 开始，通常可以轻松切换到另一种。同样，从“cmd.exe”开始，如果可以，您可以切换到 PowerShell。我们刚刚在下面的终端中运行了命令“powershell.exe”来启动 PowerShell 交互式命令行。</p>
<p>终端</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ Microsoft Windows [版本 10.0.17763.2928]</span><br><span class="line">(c) 2018 Microsoft Corporation。保留所有权利。</span><br><span class="line"></span><br><span class="line">strategos@RED-WIN-ENUM C:\Users\strategos&gt;powershell.exe</span><br><span class="line">Windows PowerShell</span><br><span class="line">版权所有 (C) Microsoft Corporation。保留所有权利。</span><br><span class="line"></span><br><span class="line">PS C:\Users\strategos&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>本房间结构如下：</p>
<ul>
<li>枚举目的</li>
<li>使用常用工具枚举 Linux 系统：系统、用户、网络和正在运行的服务</li>
<li>使用内置工具枚举 MS Windows 系统：系统、用户、网络和正在运行的服务</li>
<li>其他工具示例：Seatbelt</li>
</ul>
<p>虽然并非绝对必要，但我们建议您在进入本房间之前先完成 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/thelayoftheland">The Lay of the Land</a>。</p>
<h1 id="Purpose"><a href="#Purpose" class="headerlink" title="Purpose"></a>Purpose</h1><p>当你在目标系统上获得“shell”时，你通常对该系统只有非常基础的了解。如果是服务器，你已经知道你利用了哪些服务；然而，你不一定知道其他细节，例如用户名或网络共享。因此，shell 就像一个“暗室”，你对周围的环境只有不完整且模糊的了解。从这个意义上讲，枚举可以帮助你构建更完整、更准确的图景。</p>
<p>后漏洞利用枚举的目的是收集尽可能多的有关系统及其网络的信息。被利用的系统可能是公司台式机/笔记本电脑或服务器。我们的目标是收集这些信息，以便我们能够转向网络上的其他系统或窃取当前系统的信息。我们感兴趣的信息包括：</p>
<ul>
<li>用户和组</li>
<li>主机名</li>
<li>路由表</li>
<li>网络共享</li>
<li>网络服务</li>
<li>应用程序和banners</li>
<li>防火墙配置</li>
<li>服务设置和审核配置</li>
<li>SNMP 和 DNS 详情</li>
<li>查找凭证（保存在 Web 浏览器或客户端应用程序中）</li>
</ul>
<p>我们无法列出所有可能偶然发现的信息。例如，我们可能会找到允许我们访问其他系统的 SSH 密钥。在基于 SSH 密钥的身份验证中，我们会生成一个 SSH 密钥对（公钥和私钥）；公钥安装在服务器上。因此，服务器会信任任何能够证明拥有相关私钥的系统。</p>
<p>此外，我们可能会偶然发现保存在用户文档或桌面目录中的敏感数据。想象一下，有人可能保存了“passwords.txt”或“passwords.xlsx”而不是合适的密码管理器。源代码中也可能包含隐藏的密钥和密码，尤其是在源代码不打算公开的情况下。</p>
<h1 id="Linux-Enumeration"><a href="#Linux-Enumeration" class="headerlink" title="Linux Enumeration"></a>Linux Enumeration</h1><p>此任务重点是在访问 shell（例如 <code>bash</code>）后枚举 Linux 计算机。虽然某些命令会提供多个区域的信息，但我们尝试根据预期获取的信息将命令分为四类。</p>
<ul>
<li>系统</li>
<li>用户</li>
<li>网络</li>
<li>正在运行的服务</li>
</ul>
<h3 id="系统"><a href="#系统" class="headerlink" title="系统"></a>系统</h3><p>在 Linux 系统上，我们可以通过在 <code>/etc/</code> 中搜索以 <code>-release</code> 结尾的文件或链接来获取有关 Linux 发行版和发行版本的更多信息。运行 <code>ls /etc/*-release</code> 可以帮助我们找到此类文件。让我们看看在 CentOS Linux 上的情况。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ ls /etc/*-release</span><br><span class="line">/etc/centos-release  /etc/os-release  /etc/redhat-release  /etc/system-release</span><br><span class="line">$ cat /etc/os-release </span><br><span class="line">NAME="CentOS Linux"</span><br><span class="line">VERSION="7 (Core)"</span><br><span class="line">[...]</span><br></pre></td></tr></tbody></table></figure>

<p>让我们在 Fedora 系统上尝试一下。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ ls /etc/*-release</span><br><span class="line">/etc/fedora-release@  /etc/os-release@  /etc/redhat-release@  /etc/system-release@</span><br><span class="line">$ cat /etc/os-release</span><br><span class="line">NAME="Fedora Linux"</span><br><span class="line">VERSION="36 (Workstation Edition)"</span><br><span class="line">[...]</span><br></pre></td></tr></tbody></table></figure>

<p>我们可以使用命令“hostname”找到系统的名称。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ hostname</span><br><span class="line">rpm-red-enum.thm</span><br></pre></td></tr></tbody></table></figure>

<p>系统上的各种文件可以提供大量有用的信息。特别考虑以下文件 <code>/etc/passwd</code>、<code>/etc/group</code> 和 <code>/etc/shadow</code>。任何用户都可以读取 <code>passwd</code> 和 <code>group</code> 文件。但是，<code>shadow</code> 密码文件需要 root 权限，因为它包含哈希密码。如果您设法破解哈希值，您将知道用户的原始密码。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ cat /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">[...]</span><br><span class="line">michael:x:1001:1001::/home/michael:/bin/bash</span><br><span class="line">peter:x:1002:1002::/home/peter:/bin/bash</span><br><span class="line">jane:x:1003:1003::/home/jane:/bin/bash</span><br><span class="line">randa:x:1004:1004::/home/randa:/bin/bash</span><br><span class="line"></span><br><span class="line">$ cat /etc/group</span><br><span class="line">root:x:0:</span><br><span class="line">[...]</span><br><span class="line">michael:x:1001:</span><br><span class="line">peter:x:1002:</span><br><span class="line">jane:x:1003:</span><br><span class="line">randa:x:1004:</span><br><span class="line"></span><br><span class="line">$ sudo cat /etc/shadow</span><br><span class="line">root:$6$pZlRFi09$qqgNBS.00qtcUF9x0yHetjJbXsw0PAwQabpCilmAB47ye3OzmmJVfV6DxBYyUoWBHtTXPU0kQEVUQfPtZPO3C.:19131:0:99999:7:::</span><br><span class="line">[...]</span><br><span class="line">michael:$6$GADCGz6m$g.ROJGcSX/910DEipiPjU6clo6Z6/uBZ9Fvg3IaqsVnMA.UZtebTgGHpRU4NZFXTffjKPvOAgPKbtb2nQrVU70:19130:0:99999:7:::</span><br><span class="line">peter:$6$RN4fdNxf$wvgzdlrIVYBJjKe3s2eqlIQhvMrtwAWBsjuxL5xMVaIw4nL9pCshJlrMu2iyj/NAryBmItFbhYAVznqRcFWIz1:19130:0:99999:7:::</span><br><span class="line">jane:$6$Ees6f7QM$TL8D8yFXVXtIOY9sKjMqJ7BoHK1EHEeqM5dojTaqO52V6CPiGq2W6XjljOGx/08rSo4QXsBtLUC3PmewpeZ/Q0:19130:0:99999:7:::</span><br><span class="line">randa:$6$dYsVoPyy$WR43vaETwoWooZvR03AZGPPKxjrGQ4jTb0uAHDy2GqGEOZyXvrQNH10tGlLIHac7EZGV8hSIfuXP0SnwVmnZn0:19130:0:99999:7:::</span><br></pre></td></tr></tbody></table></figure>

<p>类似地，各种目录可以泄露有关用户的信息，并且可能包含敏感文件；其中一个是在“/var/mail/”找到的邮件目录。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ ls -lh /var/mail/</span><br><span class="line">total 4.0K</span><br><span class="line">-rw-rw----. 1 jane      mail   0 May 18 14:15 jane</span><br><span class="line">-rw-rw----. 1 michael   mail   0 May 18 14:13 michael</span><br><span class="line">-rw-rw----. 1 peter     mail   0 May 18 14:14 peter</span><br><span class="line">-rw-rw----. 1 randa     mail   0 May 18 14:15 randa</span><br><span class="line">-rw-------. 1 root      mail 639 May 19 07:37 root</span><br></pre></td></tr></tbody></table></figure>

<p>要查找已安装的应用程序，您可以考虑列出 <code>/usr/bin/</code> 和 <code>/sbin/</code> 下的文件：</p>
<ul>
<li><code>ls -lh /usr/bin/</code></li>
<li><code>ls -lh /sbin/</code></li>
</ul>
<p>在基于 RPM 的 Linux 系统上，您可以使用 <code>rpm -qa</code> 获取所有已安装软件包的列表。<code>-qa</code> 表示我们要<em>查询所有</em>软件包。</p>
<p>在基于 Debian 的 Linux 系统上，您可以使用 <code>dpkg -l</code> 获取已安装软件包的列表。以下输出来自 Ubuntu 服务器。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ dpkg -l</span><br><span class="line">Desired=Unknown/Install/Remove/Purge/Hold</span><br><span class="line">| Status=Not/Inst/Conf-files/Unpacked/halF-conf/Half-inst/trig-aWait/Trig-pend</span><br><span class="line">|/ Err?=(none)/Reinst-required (Status,Err: uppercase=bad)</span><br><span class="line">||/ Name                                  Version                            Architecture Description</span><br><span class="line">+++-=====================================-==================================-============-===============================================================================</span><br><span class="line">ii  accountsservice                       0.6.55-0ubuntu12~20.04.5           amd64        query and manipulate user account information</span><br><span class="line">ii  adduser                               3.118ubuntu2                       all          add and remove users and groups</span><br><span class="line">ii  alsa-topology-conf                    1.2.2-1                            all          ALSA topology configuration files</span><br><span class="line">ii  alsa-ucm-conf                         1.2.2-1ubuntu0.13                  all          ALSA Use Case Manager configuration files</span><br><span class="line">ii  amd64-microcode                       3.20191218.1ubuntu1                amd64        Processor microcode firmware for AMD CPUs</span><br><span class="line">[...   ]</span><br><span class="line">ii  zlib1g-dev:amd64                      1:1.2.11.dfsg-2ubuntu1.3           amd64        compression library - development</span><br></pre></td></tr></tbody></table></figure>

<h3 id="用户"><a href="#用户" class="headerlink" title="用户"></a>用户</h3><p>诸如“/etc/passwd”之类的文件会显示用户名；然而，各种命令可以提供更多关于系统中其他用户及其行踪的信息和洞察。</p>
<p>您可以使用“who”显示哪些用户已登录。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ who</span><br><span class="line">root     tty1         2022-05-18 13:24</span><br><span class="line">jane     pts/0        2022-05-19 07:17 (10.20.30.105)</span><br><span class="line">peter    pts/1        2022-05-19 07:13 (10.20.30.113)</span><br></pre></td></tr></tbody></table></figure>

<p>我们可以看到用户 <code>root</code> 直接登录系统，而用户 <code>jane</code> 和 <code>peter</code> 通过网络连接，我们可以看到他们的 IP 地址。</p>
<p>请注意，不要将 <code>who</code> 与 <code>whoami</code> 混淆，后者会打印<strong>您的</strong>有效用户 ID。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ whoami</span><br><span class="line">jane</span><br></pre></td></tr></tbody></table></figure>

<p>更进一步，您可以使用 <code>w</code> 命令，它会显示哪些用户已登录以及他们正在执行的操作。根据下面的终端输出，在本例中，<code>peter</code> 正在编辑 <code>notes.txt</code>，而 <code>jane</code> 正在运行 <code>w</code> 命令。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ w</span><br><span class="line"> 07:18:43 up 18:05,  3 users,  load average: 0.00, 0.01, 0.05</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">root     tty1                      Wed13   17:52m  0.00s  0.00s less -s</span><br><span class="line">jane     pts/0    10.20.30.105     07:17    3.00s  0.01s  0.00s w</span><br><span class="line">peter    pts/1    10.20.30.113     07:13    5:23   0.00s  0.00s vi notes.txt</span><br></pre></td></tr></tbody></table></figure>

<p>要打印真实有效的用户和组 IDS，您可以发出命令“id”（表示 ID）。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ id</span><br><span class="line">uid=1003(jane) gid=1003(jane) groups=1003(jane) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span><br></pre></td></tr></tbody></table></figure>

<p>想知道最近谁在使用系统吗？“last”会显示最近登录的用户列表；此外，我们还可以查看哪些用户退出了系统以及他们保持连接的时间。在下面的输出中，用户“randa”保持登录状态近 17 个小时，而用户“michael”在 4 分钟后退出系统。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ last</span><br><span class="line">jane     pts/0        10.20.30.105     Thu May 19 07:17   still logged in   </span><br><span class="line">peter    pts/1        10.20.30.113     Thu May 19 07:13   still logged in   </span><br><span class="line">michael  pts/0        10.20.30.1       Thu May 19 05:12 - 05:17  (00:04)    </span><br><span class="line">randa    pts/1        10.20.30.107     Wed May 18 14:18 - 07:08  (16:49)    </span><br><span class="line">root     tty1                          Wed May 18 13:24   still logged in</span><br><span class="line">[...]</span><br></pre></td></tr></tbody></table></figure>

<p>最后，值得一提的是，“sudo -l”命令会列出当前系统上调用用户允许执行的命令。</p>
<h3 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h3><p>IP 地址可以使用“ip address show”（可缩写为“ip a s”）或旧命令“ifconfig -a”（该软件包已不再维护）显示。下面的终端输出显示了网络接口“ens33”，其 IP 地址为“10.20.30.129”，子网掩码为“255.255.255.0”，实际值为“24”。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ ip a s</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="line">    link/ether 00:0c:29:a2:0e:7e brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.20.30.129/24 brd 10.20.30.255 scope global noprefixroute dynamic ens33</span><br><span class="line">       valid_lft 1580sec preferred_lft 1580sec</span><br><span class="line">    inet6 fe80::761a:b360:78:26cd/64 scope link noprefixroute </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></tbody></table></figure>

<p>DNS 服务器可以在 <code>/etc/resolv.conf</code> 中找到。请考虑以下使用 DHCP 进行网络配置的系统的终端输出。DNS（即名称服务器）设置为 <code>10.20.30.2</code>。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ cat /etc/resolv.conf</span><br><span class="line"># Generated by NetworkManager</span><br><span class="line">search localdomain thm</span><br><span class="line">nameserver 10.20.30.2</span><br></pre></td></tr></tbody></table></figure>

<p>netstat 是一个很有用的命令，可以用来了解网络连接、路由表和接口统计信息。下表解释了它的一些选项。</p>
<table>
<thead>
<tr>
<th align="left">Option</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>-a</code></td>
<td align="left">显示监听和非监听套接字</td>
</tr>
<tr>
<td align="left"><code>-l</code></td>
<td align="left">仅显示监听套接字</td>
</tr>
<tr>
<td align="left"><code>-n</code></td>
<td align="left">显示数字输出而不是解析 IP 地址和端口号</td>
</tr>
<tr>
<td align="left"><code>-t</code></td>
<td align="left">TCP</td>
</tr>
<tr>
<td align="left"><code>-u</code></td>
<td align="left">UDP</td>
</tr>
<tr>
<td align="left"><code>-x</code></td>
<td align="left">UNIX</td>
</tr>
<tr>
<td align="left"><code>-p</code></td>
<td align="left">显示套接字所属程序的 PID 和名称</td>
</tr>
</tbody></table>
<p>您可以根据需要使用任何组合。例如，<code>netstat -plt</code> 将返回“<em>正在 TCP</em> 套接字上监听的程序”。正如我们在下面的终端输出中看到的那样，<code>sshd</code> 正在监听 SSH 端口，而 <code>master</code> 正在监听 IPv4 和 IPv6 地址上的 SMTP 端口。请注意，要获取所有 PID（进程 ID）和程序名称，您需要以 root 身份运行 <code>netstat</code> 或使用 <code>sudo netstat</code>。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ sudo netstat -plt</span><br><span class="line">Active Internet connections (only servers)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    </span><br><span class="line">tcp        0      0 0.0.0.0:ssh             0.0.0.0:*               LISTEN      978/sshd            </span><br><span class="line">tcp        0      0 localhost:smtp          0.0.0.0:*               LISTEN      1141/master         </span><br><span class="line">tcp6       0      0 [::]:ssh                [::]:*                  LISTEN      978/sshd            </span><br><span class="line">tcp6       0      0 localhost:smtp          [::]:*                  LISTEN      1141/master</span><br></pre></td></tr></tbody></table></figure>

<p><code>netstat -atupn</code> 将显示 <em>所有 TCP 和 UDP</em> 正在监听和已建立的连接以及带有地址和端口的 <em>程序</em> 名称（以 <em>数字</em> 格式）。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ sudo netstat -atupn</span><br><span class="line">Active Internet connections (servers and established)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    </span><br><span class="line">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      978/sshd            </span><br><span class="line">tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      1141/master         </span><br><span class="line">tcp        0      0 10.20.30.129:22         10.20.30.113:38822        ESTABLISHED 5665/sshd: peter [p </span><br><span class="line">tcp        0      0 10.20.30.129:22         10.20.30.105:38826        ESTABLISHED 5723/sshd: jane [pr </span><br><span class="line">tcp6       0      0 :::22                   :::*                    LISTEN      978/sshd            </span><br><span class="line">tcp6       0      0 ::1:25                  :::*                    LISTEN      1141/master         </span><br><span class="line">udp        0      0 127.0.0.1:323           0.0.0.0:*                           640/chronyd         </span><br><span class="line">udp        0      0 0.0.0.0:68              0.0.0.0:*                           5638/dhclient       </span><br><span class="line">udp6       0      0 ::1:323                 :::*                                640/chronyd</span><br></pre></td></tr></tbody></table></figure>

<p>有人可能会认为，在获得目标机器的访问权限之前使用“nmap”也能获得类似的结果。然而，这并不完全正确。Nmap 需要生成相对大量的数据包来检查开放端口，这可能会触发入侵检测和防御系统。此外，路由上的防火墙可能会丢弃某些数据包并阻碍扫描，导致 Nmap 结果不完整。</p>
<p>“lsof”代表列出打开的文件。如果我们只想显示互联网和网络连接，可以使用“lsof -i”。下面的终端输出显示了 IPv4 和 IPv6 的监听服务以及正在进行的连接。用户“peter”通过“ssh”端口连接到服务器“rpm-red-enum.thm”。请注意，要获取匹配程序的完整列表，您需要以 root 身份运行“lsof”或使用“sudo lsof”。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ sudo lsof -i</span><br><span class="line">COMMAND   PID      USER   FD   TYPE DEVICE SIZE/OFF NODE NAME</span><br><span class="line">chronyd   640    chrony    5u  IPv4  16945      0t0  UDP localhost:323 </span><br><span class="line">chronyd   640    chrony    6u  IPv6  16946      0t0  UDP localhost:323 </span><br><span class="line">sshd      978      root    3u  IPv4  20035      0t0  TCP *:ssh (LISTEN)</span><br><span class="line">sshd      978      root    4u  IPv6  20058      0t0  TCP *:ssh (LISTEN)</span><br><span class="line">master   1141      root   13u  IPv4  20665      0t0  TCP localhost:smtp (LISTEN)</span><br><span class="line">master   1141      root   14u  IPv6  20666      0t0  TCP localhost:smtp (LISTEN)</span><br><span class="line">dhclient 5638      root    6u  IPv4  47458      0t0  UDP *:bootpc </span><br><span class="line">sshd     5693     peter    3u  IPv4  47594      0t0  TCP rpm-red-enum.thm:ssh-&gt;10.20.30.113:38822 (ESTABLISHED)</span><br><span class="line">[...]</span><br></pre></td></tr></tbody></table></figure>

<p>由于列表可能很长，您可以通过指定感兴趣的端口（例如 SMTP 端口 25）来进一步过滤输出。通过运行 <code>lsof -i :25</code>，我们将输出限制为与端口 25 相关的输出，如下面的终端输出所示。该服务器在 IPv4 和 IPv6 地址上都监听端口 25。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ sudo lsof -i :25</span><br><span class="line">COMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME</span><br><span class="line">master  1141 root   13u  IPv4  20665      0t0  TCP localhost:smtp (LISTEN)</span><br><span class="line">master  1141 root   14u  IPv6  20666      0t0  TCP localhost:smtp (LISTEN)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="正在运行的服务"><a href="#正在运行的服务" class="headerlink" title="正在运行的服务"></a>正在运行的服务</h3><p>获取正在运行的进程的快照可以提供很多见解。“ps”命令可以让你发现正在运行的进程以及有关它们的大量信息。</p>
<p>你可以使用“ps -e”命令列出系统上的所有进程，其中“-e”命令表示选择所有进程。要获取有关进程的更多信息，你可以添加“-f”命令以显示完整格式，或添加“-l”命令以显示长格式。你可以尝试使用“ps -e”、“ps -ef”和“ps -el”命令。</p>
<p>你可以使用 BSD 语法“ps ax”或“ps aux”命令获得类似的输出并查看所有进程。请注意，使用 BSD 语法时，“a”和“x”命令是必需的，因为它们可以解除“仅限你自己”和“必须拥有 tty”的限制；换句话说，这样就可以显示所有进程。“u”命令用于显示拥有该进程的用户的详细信息。</p>
<table>
<thead>
<tr>
<th align="left">Option</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>-e</code></td>
<td align="left">所有进程</td>
</tr>
<tr>
<td align="left"><code>-f</code></td>
<td align="left">完整格式列表</td>
</tr>
<tr>
<td align="left"><code>-j</code></td>
<td align="left">工作格式</td>
</tr>
<tr>
<td align="left"><code>-l</code></td>
<td align="left">长格式</td>
</tr>
<tr>
<td align="left"><code>-u</code></td>
<td align="left">面向用户的格式</td>
</tr>
</tbody></table>
<p>为了获得更“直观”的输出，你可以使用 <code>ps axjf</code> 命令来打印进程树。<code>f</code> 代表“森林”，它会创建一个 ASCII 艺术形式的进程层次结构，如下面的终端输出所示。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ ps axf</span><br><span class="line">   PID TTY      STAT   TIME COMMAND</span><br><span class="line">     2 ?        S      0:00 [kthreadd]</span><br><span class="line">     4 ?        S&lt;     0:00  \_ [kworker/0:0H]</span><br><span class="line">     5 ?        S      0:01  \_ [kworker/u256:0]</span><br><span class="line">[...]</span><br><span class="line">   978 ?        Ss     0:00 /usr/sbin/sshd -D</span><br><span class="line">  5665 ?        Ss     0:00  \_ sshd: peter [priv]</span><br><span class="line">  5693 ?        S      0:00  |   \_ sshd: peter@pts/1</span><br><span class="line">  5694 pts/1    Ss     0:00  |       \_ -bash</span><br><span class="line">  5713 pts/1    S+     0:00  |           \_ vi notes.txt</span><br><span class="line">  5723 ?        Ss     0:00  \_ sshd: jane [priv]</span><br><span class="line">  5727 ?        S      0:00      \_ sshd: jane@pts/0</span><br><span class="line">  5728 pts/0    Ss     0:00          \_ -bash</span><br><span class="line">  7080 pts/0    R+     0:00              \_ ps axf</span><br><span class="line">   979 ?        Ssl    0:12 /usr/bin/python2 -Es /usr/sbin/tuned -l -P</span><br><span class="line">   981 ?        Ssl    0:07 /usr/sbin/rsyslogd -n</span><br><span class="line">  1141 ?        Ss     0:00 /usr/libexec/postfix/master -w</span><br><span class="line">  1147 ?        S      0:00  \_ qmgr -l -t unix -u</span><br><span class="line">  6991 ?        S      0:00  \_ pickup -l -t unix -u</span><br><span class="line">  1371 ?        Ss     0:00 login -- root</span><br><span class="line">  1376 tty1     Ss     0:00  \_ -bash</span><br><span class="line">  1411 tty1     S+     0:00      \_ man man</span><br><span class="line">  1420 tty1     S+     0:00          \_ less -s</span><br><span class="line">[...]</span><br></pre></td></tr></tbody></table></figure>

<p>总而言之，记得使用 <code>ps -ef</code> 或 <code>ps aux</code> 来获取所有正在运行的进程列表。考虑使用 <code>grep</code> 管道输出，以显示包含特定单词的输出行。下面的终端输出显示了包含 <code>peter</code> 的行。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ ps -ef | grep peter</span><br><span class="line">root       5665    978  0 07:11 ?        00:00:00 sshd: peter [priv]</span><br><span class="line">peter      5693   5665  0 07:13 ?        00:00:00 sshd: peter@pts/1</span><br><span class="line">peter      5694   5693  0 07:13 pts/1    00:00:00 -bash</span><br><span class="line">peter      5713   5694  0 07:13 pts/1    00:00:00 vi notes.txt</span><br></pre></td></tr></tbody></table></figure>

<h1 id="Windows-Enumeration"><a href="#Windows-Enumeration" class="headerlink" title="Windows Enumeration"></a>Windows Enumeration</h1><p>在此任务中，我们假设您有权访问 Microsoft Windows 主机上的 <code>cmd</code>。您可能通过利用漏洞获取 shell 或反向 shell 获得了此访问权限。您也可能在被利用的系统上安装了后门或设置了 SSH 服务器。在所有情况下，以下命令都需要 <code>cmd</code> 才能运行。</p>
<p>在此任务中，我们专注于枚举 MS Windows 主机。要枚举 MS Active Directory，建议您查看 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/adenumeration">枚举 Active Directory</a> 房间。如果您对 MS Windows 主机上的权限提升感兴趣，我们推荐 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/windowsprivesc20">Windows Privesc 2.0</a> 房间。</p>
<h3 id="系统-1"><a href="#系统-1" class="headerlink" title="系统"></a>系统</h3><p>“systeminfo”命令可以提供有关系统的详细信息，例如其版本号和已安装的补丁程序。在下面的示例中，我们可以看到已安装哪些修补程序。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">C:\&gt;systeminfo</span><br><span class="line"></span><br><span class="line">Host Name:                 WIN-SERVER-CLI</span><br><span class="line">OS Name:                   Microsoft Windows Server 2022 Standard</span><br><span class="line">OS Version:                10.0.20348 N/A Build 20348</span><br><span class="line">OS Manufacturer:           Microsoft Corporation</span><br><span class="line">[...]</span><br><span class="line">Hotfix(s):                 3 Hotfix(s) Installed.</span><br><span class="line">                           [01]: KB5013630</span><br><span class="line">                           [02]: KB5013944</span><br><span class="line">                           [03]: KB5012673</span><br><span class="line">Network Card(s):           1 NIC(s) Installed.</span><br><span class="line">                           [01]: Intel(R) 82574L Gigabit Network Connection</span><br><span class="line">[...]</span><br></pre></td></tr></tbody></table></figure>

<p>您可以使用“wmic qfe get Caption,Description”检查已安装的更新。这些信息将帮助您了解系统修补和更新的速度。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">C:\&gt;wmic qfe get Caption,Description</span><br><span class="line">Caption                                     Description      </span><br><span class="line">http://support.microsoft.com/?kbid=5013630  Update</span><br><span class="line">https://support.microsoft.com/help/5013944  Security Update</span><br><span class="line">                                            Update</span><br></pre></td></tr></tbody></table></figure>

<p>您可以使用“net start”检查已安装和已启动的 Windows 服务。预计会得到一个较长的列表；以下输出已被截取。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">C:\&gt;net start</span><br><span class="line">These Windows services are started:</span><br><span class="line"></span><br><span class="line">   Base Filtering Engine</span><br><span class="line">   Certificate Propagation</span><br><span class="line">   Client License Service (ClipSVC)</span><br><span class="line">   COM+ Event System</span><br><span class="line">   Connected User Experiences and Telemetry</span><br><span class="line">   CoreMessaging</span><br><span class="line">   Cryptographic Services</span><br><span class="line">   DCOM Server Process Launcher</span><br><span class="line">   DHCP Client</span><br><span class="line">   DNS Client</span><br><span class="line">[...]</span><br><span class="line">   Windows Time</span><br><span class="line">   Windows Update</span><br><span class="line">   WinHTTP Web Proxy Auto-Discovery Service</span><br><span class="line">   Workstation</span><br><span class="line"></span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></tbody></table></figure>

<p>如果您只对已安装的应用程序感兴趣，可以执行“wmic product get name,version,vendor”。如果您在连接的虚拟机上运行此命令，您将获得类似于以下输出的内容。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">C:\&gt;wmic product get name,version,vendor</span><br><span class="line">Name                                                            Vendor                                   Version</span><br><span class="line">Microsoft Visual C++ 2019 X64 Minimum Runtime - 14.28.29910     Microsoft Corporation                    14.28.29910</span><br><span class="line">[...]</span><br><span class="line">Microsoft Visual C++ 2019 X64 Additional Runtime - 14.28.29910  Microsoft Corporation                    14.28.29910</span><br></pre></td></tr></tbody></table></figure>

<h3 id="用户-1"><a href="#用户-1" class="headerlink" title="用户"></a>用户</h3><p>要了解您的身份，您可以运行“whoami”；此外，要了解您的权限，即您的权限，您可以使用“whoami /priv”。以下终端输出显示了一个示例。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">C:\&gt;whoami</span><br><span class="line">win-server-cli\strategos</span><br><span class="line"></span><br><span class="line">&gt; whoami /priv</span><br><span class="line"></span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Privilege Name                            Description                                                        State</span><br><span class="line">========================================= ================================================================== =======</span><br><span class="line">SeIncreaseQuotaPrivilege                  Adjust memory quotas for a process                                 Enabled</span><br><span class="line">SeSecurityPrivilege                       Manage auditing and security log                                   Enabled</span><br><span class="line">SeTakeOwnershipPrivilege                  Take ownership of files or other objects                           Enabled</span><br><span class="line">[...]</span><br></pre></td></tr></tbody></table></figure>

<p>此外，您可以使用 <code>whoami /groups</code> 来了解您属于哪些组。下面的终端输出显示，该用户属于 <code>NT AUTHORITY\Local account and members of Administrators group</code> 以及其他组。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">C:\&gt;whoami /groups</span><br><span class="line"></span><br><span class="line">GROUP INFORMATION</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">Group Name                                                    Type             SID          Attributes</span><br><span class="line">============================================================= ================ ============ ===============================================================</span><br><span class="line">Everyone                                                      Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group</span><br><span class="line">NT AUTHORITY\Local account and member of Administrators group Well-known group S-1-5-114    Mandatory group, Enabled by default, Enabled group</span><br><span class="line">BUILTIN\Administrators                                        Alias            S-1-5-32-544 Mandatory group, Enabled by default, Enabled group, Group owner</span><br><span class="line">[...]</span><br></pre></td></tr></tbody></table></figure>

<p>您可以通过运行“net user”来查看用户。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">C:\&gt;net user</span><br><span class="line"></span><br><span class="line">User accounts for \\WIN-SERVER-CLI</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">Administrator            DefaultAccount           Guest</span><br><span class="line">michael                  peter                    strategos</span><br><span class="line">WDAGUtilityAccount</span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></tbody></table></figure>

<p>如果系统是 Windows 域控制器，则可以使用“net group”发现可用的组，否则使用“net localgroup”，如下面的终端所示。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">C:\&gt;net localgroup</span><br><span class="line"></span><br><span class="line">Aliases for \\WIN-SERVER-CLI</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">*Access Control Assistance Operators</span><br><span class="line">*Administrators</span><br><span class="line">*Backup Operators</span><br><span class="line">*Certificate Service DCOM Access</span><br><span class="line">*Cryptographic Operators</span><br><span class="line">*Device Owners</span><br><span class="line">[...]</span><br></pre></td></tr></tbody></table></figure>

<p>您可以使用命令“net localgroup administrators”列出属于本地管理员组的用户。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">C:\&gt;net localgroup administrators</span><br><span class="line">Alias name     administrators</span><br><span class="line">Comment        Administrators have complete and unrestricted access to the computer/domain</span><br><span class="line"></span><br><span class="line">Members</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">Administrator</span><br><span class="line">michael</span><br><span class="line">peter</span><br><span class="line">strategos</span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></tbody></table></figure>

<p>使用 <code>net accounts</code> 查看计算机的本地设置；此外，如果计算机属于域，则可以使用 <code>net accounts /domain</code>。此命令有助于了解密码策略，例如最小密码长度、最长密码使用期限和锁定时长。</p>
<h3 id="网络-1"><a href="#网络-1" class="headerlink" title="网络"></a>网络</h3><p>您可以使用 <code>ipconfig</code> 命令了解系统的网络配置。如果您想了解所有与网络相关的设置，可以使用 <code>ipconfig /all</code>。下面的终端输出显示了使用 <code>ipconfig</code> 时的输出。例如，如果我们想了解 DNS 服务器，可以使用 <code>ipconfig /all</code>。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">C:\&gt;ipconfig</span><br><span class="line"></span><br><span class="line">Windows IP Configuration</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Ethernet adapter Ethernet0:</span><br><span class="line"></span><br><span class="line">   Connection-specific DNS Suffix  . : localdomain</span><br><span class="line">   Link-local IPv6 Address . . . . . : fe80::3dc5:78ef:1274:a740%5</span><br><span class="line">   IPv4 Address. . . . . . . . . . . : 10.20.30.130</span><br><span class="line">   Subnet Mask . . . . . . . . . . . : 255.255.255.0</span><br><span class="line">   Default Gateway . . . . . . . . . : 10.20.30.2</span><br></pre></td></tr></tbody></table></figure>

<p>在 MS Windows 上，我们可以使用 <code>netstat</code> 获取各种信息，例如系统正在监听哪些端口、哪些连接处于活动状态以及谁正在使用这些连接。在本例中，我们使用选项 <code>-a</code> 显示所有监听端口和活动连接。<code>-b</code> 可以让我们找到参与连接的二进制文件，而 <code>-n</code> 用于避免解析 IP 地址和端口号。最后，<code>-o</code> 显示进程 ID (PID)。</p>
<p>在下面显示的部分输出中，我们可以看到 <code>netstat -abno</code> 显示服务器正在监听 TCP 端口 22、135、445 和 3389。进程 <code>sshd.exe</code>、<code>RpcSs</code> 和 <code>TermService</code> 分别位于端口 <code>22</code>、<code>135</code> 和 <code>3389</code> 上。此外，我们可以看到两个已建立的与 SSH 服务器的连接，状态为 <code>ESTABLISHED</code>。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">C:\&gt;netstat -abno</span><br><span class="line"></span><br><span class="line">Active Connections</span><br><span class="line"></span><br><span class="line">  Proto  Local Address          Foreign Address        State           PID</span><br><span class="line">  TCP    0.0.0.0:22             0.0.0.0:0              LISTENING       2016</span><br><span class="line"> [sshd.exe]</span><br><span class="line">  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       924</span><br><span class="line">  RpcSs</span><br><span class="line"> [svchost.exe]</span><br><span class="line">  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4</span><br><span class="line"> Can not obtain ownership information</span><br><span class="line">  TCP    0.0.0.0:3389           0.0.0.0:0              LISTENING       416</span><br><span class="line">  TermService</span><br><span class="line"> [svchost.exe]</span><br><span class="line">[...]</span><br><span class="line">  TCP    10.20.30.130:22        10.20.30.1:39956       ESTABLISHED     2016</span><br><span class="line"> [sshd.exe]</span><br><span class="line">  TCP    10.20.30.130:22        10.20.30.1:39964       ESTABLISHED     2016</span><br><span class="line"> [sshd.exe]</span><br><span class="line">[...]</span><br></pre></td></tr></tbody></table></figure>

<p>您可能认为通过端口扫描目标系统可以获得相同的结果；然而，这不准确，原因有二。防火墙可能阻止扫描主机访问特定的网络端口。此外，端口扫描系统会产生大量流量，而不像 <code>netstat</code> 那样产生任何噪音。</p>
<p>最后，值得一提的是，使用 <code>arp -a</code> 可以帮助您发现同一局域网内最近与您的系统通信的其他系统。ARP 代表地址解析协议；<code>arp -a</code> 显示当前的 ARP 条目，即同一局域网内与您的系统通信的系统的物理地址。示例输出如下所示。这表明这些 IP 地址已经以某种方式与我们的系统进行了通信；该通信可以是尝试连接，也可以是简单的 ping。请注意，<code>10.10.255.255</code> 并不代表一个系统，因为它是子网广播地址。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">C:\&gt;arp -a</span><br><span class="line"></span><br><span class="line">Interface: 10.10.204.175 --- 0x4 </span><br><span class="line">  Internet Address      Physical Address      Type</span><br><span class="line">  10.10.0.1             02-c8-85-b5-5a-aa     dynamic</span><br><span class="line">  10.10.16.117          02-f2-42-76-fc-ef     dynamic</span><br><span class="line">  10.10.122.196         02-48-58-7b-92-e5     dynamic</span><br><span class="line">  10.10.146.13          02-36-c1-4d-05-f9     dynamic</span><br><span class="line">  10.10.161.4           02-a8-58-98-1a-d3     dynamic</span><br><span class="line">  10.10.217.222         02-68-10-dd-be-8d     dynamic</span><br><span class="line">  10.10.255.255         ff-ff-ff-ff-ff-ff     static</span><br></pre></td></tr></tbody></table></figure>

<h1 id="DNS-SMB-and-SNMP"><a href="#DNS-SMB-and-SNMP" class="headerlink" title="DNS, SMB, and SNMP"></a>DNS, SMB, and SNMP</h1><p>在我们讨论枚举时，最好先了解一下 DNS、SMB 和 SNMP。</p>
<h3 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h3><p>我们都熟悉域名系统 (DNS) 查询，例如 A、AAAA、CName 和 TXT 记录等。如果您想复习一下 DNS 知识，建议您访问 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/dnsindetail">DNS 详解</a> 聊天室。如果我们能获得 DNS 服务器负责应答的所有记录的“副本”，我们或许就能发现一些我们之前并不知道存在的主机。</p>
<p>尝试 DNS 区域传输的一个简单方法是使用 <code>dig</code> 命令。如果您想了解更多关于 <code>dig</code> 和类似命令的信息，建议您访问 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/passiverecon">被动侦察</a> 聊天室。根据 DNS 服务器的配置，DNS 区域传输可能会受到限制。如果没有限制，可以使用“dig -t AXFR DOMAIN_NAME @DNS_SERVER”命令。“-t AXFR”表示我们正在请求区域传输，而“@”位于“DNS_SERVER”之前，表示我们要查询与指定“DOMAIN_NAME”相关的记录。</p>
<h3 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h3><p>服务器消息块 (SMB) 是一种提供文件和打印机共享访问的通信协议。我们可以使用“net share”命令检查共享文件夹。以下是输出示例。我们可以看到“C:\Internal Files”以名称“<em>Internal</em>”共享。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">user@TryHackMe$ net share</span><br><span class="line"></span><br><span class="line">Share name   Resource                        Remark</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">C$           C:\                             Default share</span><br><span class="line">IPC$                                         Remote IPC</span><br><span class="line">ADMIN$       C:\Windows                      Remote Admin</span><br><span class="line">Internal     C:\Internal Files               Internal Documents</span><br><span class="line">Users        C:\Users</span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></tbody></table></figure>

<h3 id="SNMP"><a href="#SNMP" class="headerlink" title="SNMP"></a>SNMP</h3><p>简单网络管理协议 (SNMP) 旨在帮助收集网络上不同设备的信息。它可以让您了解各种网络事件，从服务器磁盘故障到打印机缺墨。因此，SNMP 可以为攻击者提供大量信息。“snmpcheck” 是一个查询与 SNMP 相关的服务器的简单工具。您可以在 AttackBox 的“/opt/snmpcheck/”目录中找到它；其语法非常简单：/opt/snmpcheck/snmpcheck.rb MACHINE_IP -c COMMUNITY_STRING”。</p>
<p>如果您想在本地 Linux 系统上安装“snmpcheck”，请考虑以下命令。</p>
<p>Terminal</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">git clone https://gitlab.com/kalilinux/packages/snmpcheck.git</span><br><span class="line">cd snmpcheck/</span><br><span class="line">gem install snmp</span><br><span class="line">chmod +x snmpcheck-1.9.rb</span><br></pre></td></tr></tbody></table></figure>

<h1 id="More-Tools-for-Windows"><a href="#More-Tools-for-Windows" class="headerlink" title="More Tools for Windows"></a>More Tools for Windows</h1><p>在本课程中，我们重点介绍了任何现代 MS Windows 系统上均可使用的命令行内置工具。我们没有介绍图形用户界面 (GUI) 工具；此外，我们也没有介绍任何需要额外下载和安装步骤的程序。</p>
<p>此任务提到了三个非内置命令行工具：</p>
<ul>
<li>Sysinternals Suite</li>
<li>Process Hacker</li>
<li>GhostPack Seatbelt</li>
</ul>
<h3 id="Sysinternals-Suite"><a href="#Sysinternals-Suite" class="headerlink" title="Sysinternals Suite"></a>Sysinternals Suite</h3><p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/sysinternals/downloads/">Sysinternals Suite</a> 是一组命令行和 GUI 实用程序及工具，提供与 Windows 系统相关的各个方面的信息。为了方便您参考，我们在下表中列出了一些示例。</p>
<table>
<thead>
<tr>
<th align="left">实用程序名称</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Process Explorer</td>
<td align="left">显示进程以及打开的文件和注册表项</td>
</tr>
<tr>
<td align="left">Process Monitor</td>
<td align="left">监控文件系统、进程和注册表</td>
</tr>
<tr>
<td align="left">PsList</td>
<td align="left">提供进程信息</td>
</tr>
<tr>
<td align="left">PsLoggedOn</td>
<td align="left">显示已登录用户</td>
</tr>
</tbody></table>
<p>查看 <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/sysinternals/downloads/">Sysinternals 实用程序索引</a> 获取完整的实用程序列表。如果您想了解更多信息并试用这些不同的实用程序，我们建议您访问 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/btsysinternalssg">Sysinternals</a> 聊天室。</p>
<h3 id="Process-Hacker"><a href="#Process-Hacker" class="headerlink" title="Process Hacker"></a>Process Hacker</h3><p><a target="_blank" rel="noopener" href="https://processhacker.sourceforge.io/">Process Hacker</a> 是另一个高效可靠的 MS Windows GUI 工具，可让您收集有关正在运行的进程的信息。Process Hacker 可为您提供有关正在运行的进程和相关活动网络连接的详细信息；此外，它还能让您深入了解从 CPU、内存到磁盘和网络的系统资源利用率。</p>
<h3 id="GhostPack-Seatbelt"><a href="#GhostPack-Seatbelt" class="headerlink" title="GhostPack Seatbelt"></a>GhostPack Seatbelt</h3><p><a target="_blank" rel="noopener" href="https://github.com/GhostPack/Seatbelt">Seatbelt</a> 是 GhostPack 套件的一部分，是一款用 C# 编写的工具。它尚未正式发布二进制版本；因此，您需要使用 MS Visual Studio 自行编译。</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>本次会议的重点是 Linux 和 MS Windows 系统中内置的命令行工具。这两个系统中都包含许多命令，尽管命令参数和输出结果有所不同。下表列出了我们用来获取更多系统信息的主要 Linux 和 MS Windows 命令。</p>
<table>
<thead>
<tr>
<th align="left">Linux 命令</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>hostname</code></td>
<td align="left">显示系统的主机名</td>
</tr>
<tr>
<td align="left"><code>who</code></td>
<td align="left">显示已登录用户</td>
</tr>
<tr>
<td align="left"><code>whoami</code></td>
<td align="left">显示有效用户名</td>
</tr>
<tr>
<td align="left"><code>w</code></td>
<td align="left">显示已登录用户及其当前操作</td>
</tr>
<tr>
<td align="left"><code>last</code></td>
<td align="left">显示最近登录用户的列表</td>
</tr>
<tr>
<td align="left"><code>ip address show</code></td>
<td align="left">显示网络接口和地址</td>
</tr>
<tr>
<td align="left"><code>arp</code></td>
<td align="left">显示 ARP 缓存</td>
</tr>
<tr>
<td align="left"><code>netstat</code></td>
<td align="left">打印网络连接</td>
</tr>
<tr>
<td align="left"><code>ps</code></td>
<td align="left">显示当前进程的快照</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="left">Windows 命令</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>systeminfo</code></td>
<td align="left">显示操作系统配置信息，包括服务包级别</td>
</tr>
<tr>
<td align="left"><code>whoami</code></td>
<td align="left">显示用户名和组信息以及相应的安全标识符</td>
</tr>
<tr>
<td align="left"><code>netstat</code></td>
<td align="left">显示协议统计信息和当前 TCP/IP 网络连接</td>
</tr>
<tr>
<td align="left"><code>net user</code></td>
<td align="left">显示计算机上的用户帐户</td>
</tr>
<tr>
<td align="left"><code>net localgroup</code></td>
<td align="left">显示计算机上的本地组</td>
</tr>
<tr>
<td align="left"><code>arp</code></td>
<td align="left">显示 IP 地址到物理地址的转换表</td>
</tr>
</tbody></table>
<p>本聊天室重点介绍 Linux 或 MS Windows 计算机的后漏洞利用枚举。有关与 Active Directory 相关的枚举，我们建议您加入 <a target="_blank" rel="noopener" href="https://tryhackme.com/room/adenumeration">枚举 AD</a> 聊天室。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://blog.mikannse.cn">Mikannse</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.mikannse.cn/2025/06/13/THMEnumeration/">https://blog.mikannse.cn/2025/06/13/THMEnumeration/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.mikannse.cn" target="_blank">MikannseのSekai</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a><a class="post-meta__tags" href="/tags/%E5%90%8E%E6%B8%97%E9%80%8F/">后渗透</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2023/06/22/PMAjL6lORKa5CGy.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/06/13/THMTheLayoftheLand/" title="THMTheLayoftheLand"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">THMTheLayoftheLand</div></div></a></div><div class="next-post pull-right"><a href="/2025/06/13/kagglePandas%E9%87%8D%E5%91%BD%E5%90%8D%E5%92%8C%E5%90%88%E5%B9%B6/" title="kagglePandas重命名和合并"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">kagglePandas重命名和合并</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2025/06/13/THMTheLayoftheLand/" title="THMTheLayoftheLand"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-13</div><div class="title">THMTheLayoftheLand</div></div></a></div><div><a href="/2024/06/15/AdvancedSQLInjectionTHM/" title="AdvancedSQLInjectionTHM"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-15</div><div class="title">AdvancedSQLInjectionTHM</div></div></a></div><div><a href="/2024/07/19/CSS%E9%9A%8F%E6%89%8B%E8%AE%B0/" title="CSS随手记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-19</div><div class="title">CSS随手记</div></div></a></div><div><a href="/2023/09/13/CVE-2016-4437shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" title="CVE-2016-4437shiro反序列化漏洞复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-13</div><div class="title">CVE-2016-4437shiro反序列化漏洞复现</div></div></a></div><div><a href="/2024/04/06/CVE-2019-11043PHP-FPM%E8%BF%9C%E7%A8%8BRCE%E5%A4%8D%E7%8E%B0/" title="CVE-2019-11043PHP-FPM远程RCE复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-06</div><div class="title">CVE-2019-11043PHP-FPM远程RCE复现</div></div></a></div><div><a href="/2025/04/24/CVE-2021-44228Log4j%E5%A4%8D%E7%8E%B0/" title="CVE-2021-44228Log4j复现"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-24</div><div class="title">CVE-2021-44228Log4j复现</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s2.loli.net/2023/06/22/PMAjL6lORKa5CGy.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Mikannse</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">345</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">76</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mikannse/mikannse.github.io"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">暂时没有公告QAQ</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Purpose"><span class="toc-number">2.</span> <span class="toc-text">Purpose</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Linux-Enumeration"><span class="toc-number">3.</span> <span class="toc-text">Linux Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F"><span class="toc-number">3.0.1.</span> <span class="toc-text">系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7"><span class="toc-number">3.0.2.</span> <span class="toc-text">用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C"><span class="toc-number">3.0.3.</span> <span class="toc-text">网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%9C%A8%E8%BF%90%E8%A1%8C%E7%9A%84%E6%9C%8D%E5%8A%A1"><span class="toc-number">3.0.4.</span> <span class="toc-text">正在运行的服务</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Windows-Enumeration"><span class="toc-number">4.</span> <span class="toc-text">Windows Enumeration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F-1"><span class="toc-number">4.0.1.</span> <span class="toc-text">系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7-1"><span class="toc-number">4.0.2.</span> <span class="toc-text">用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C-1"><span class="toc-number">4.0.3.</span> <span class="toc-text">网络</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DNS-SMB-and-SNMP"><span class="toc-number">5.</span> <span class="toc-text">DNS, SMB, and SNMP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DNS"><span class="toc-number">5.0.1.</span> <span class="toc-text">DNS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SMB"><span class="toc-number">5.0.2.</span> <span class="toc-text">SMB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SNMP"><span class="toc-number">5.0.3.</span> <span class="toc-text">SNMP</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#More-Tools-for-Windows"><span class="toc-number">6.</span> <span class="toc-text">More Tools for Windows</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Sysinternals-Suite"><span class="toc-number">6.0.1.</span> <span class="toc-text">Sysinternals Suite</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Process-Hacker"><span class="toc-number">6.0.2.</span> <span class="toc-text">Process Hacker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GhostPack-Seatbelt"><span class="toc-number">6.0.3.</span> <span class="toc-text">GhostPack Seatbelt</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Conclusion"><span class="toc-number">7.</span> <span class="toc-text">Conclusion</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/01/kaggleIntermediateMachineLearning%E7%BC%BA%E5%A4%B1%E5%80%BC/" title="kaggleIntermediateMachineLearning缺失值">kaggleIntermediateMachineLearning缺失值</a><time datetime="2025-07-01T11:31:19.000Z" title="发表于 2025-07-01 19:31:19">2025-07-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/01/kaggleIntermediateMachineLearningIntroduction/" title="kaggleIntermediateMachineLearningIntroduction">kaggleIntermediateMachineLearningIntroduction</a><time datetime="2025-07-01T11:28:32.000Z" title="发表于 2025-07-01 19:28:32">2025-07-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/13/THMTheLayoftheLand/" title="THMTheLayoftheLand">THMTheLayoftheLand</a><time datetime="2025-06-13T08:52:38.000Z" title="发表于 2025-06-13 16:52:38">2025-06-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/13/THMEnumeration/" title="THMEnumeration">THMEnumeration</a><time datetime="2025-06-13T08:51:27.000Z" title="发表于 2025-06-13 16:51:27">2025-06-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/13/kagglePandas%E9%87%8D%E5%91%BD%E5%90%8D%E5%92%8C%E5%90%88%E5%B9%B6/" title="kagglePandas重命名和合并">kagglePandas重命名和合并</a><time datetime="2025-06-13T02:28:23.000Z" title="发表于 2025-06-13 10:28:23">2025-06-13</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.jsdelivr.net/gh/yjr-1100/Photobag/githubioimg/background_4k.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By Mikannse</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat-btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  const disqus_config = function () {
    this.page.url = 'https://blog.mikannse.cn/2025/06/13/THMEnumeration/'
    this.page.identifier = '/2025/06/13/THMEnumeration/'
    this.page.title = 'THMEnumeration'
  }

  const disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  btf.addModeChange('disqus', disqusReset)

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Valine' === 'Disqus' || !true) {
  if (true) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>